<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keyosk Í≤∞Ï†ú</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='checkout.css') }}">
</head>
<body>
    <div class="kiosk-container">
        <div class="kiosk-content">
            <div class="checkout-screen">
                <header class="checkout-header">
                    <h1 class="title">Í≤∞Ï†ú</h1>
                </header>
                
                <main class="checkout-content">
                    <div class="order-summary">
                        <h2 class="section-title">Ï£ºÎ¨∏ ÎÇ¥Ïó≠</h2>
                        <div class="order-items" id="order-items-container">
                            <!-- Ïû•Î∞îÍµ¨Îãà Ìï≠Î™©Îì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                        </div>
                        <div class="order-total">
                            <div class="total-row">
                                <span>Ï¥ù Í≤∞Ï†ú Í∏àÏï°</span>
                                <span id="total-amount">0Ïõê</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="checkout-options">
                        <div class="option-section">
                            <h2 class="section-title">Ìè¨Ïû• ÏÑ†ÌÉù</h2>
                            <div class="option-buttons">
                                <button class="option-btn active" data-option="takeout">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M21 5H3C1.89543 5 1 5.89543 1 7V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V7C23 5.89543 22.1046 5 21 5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M16 3V7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M8 3V7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    Ìè¨Ïû•
                                </button>
                                <button class="option-btn" data-option="instore">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M18 8H19C20.0609 8 21.0783 8.42143 21.8284 9.17157C22.5786 9.92172 23 10.9391 23 12C23 13.0609 22.5786 14.0783 21.8284 14.8284C21.0783 15.5786 20.0609 16 19 16H18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M2 8H18V17C18 18.0609 17.5786 19.0783 16.8284 19.8284C16.0783 20.5786 15.0609 21 14 21H6C4.93913 21 3.92172 20.5786 3.17157 19.8284C2.42143 19.0783 2 18.0609 2 17V8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M6 1V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M10 1V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M14 1V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    Îß§Ïû•
                                </button>
                            </div>
                        </div>
                        
                        <div class="option-section stamp-section">
                            <h2 class="section-title">Ïä§ÌÉ¨ÌîÑ Ï†ÅÎ¶Ω</h2>
                            <div class="stamp-info">
                                <div class="stamp-count" id="stamp-count">
                                    <!-- Ïä§ÌÉ¨ÌîÑ ÏïÑÏù¥ÏΩòÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                                </div>
                                <p class="stamp-text">
                                    Í≥†Í∞ùÎãòÏùò Ïä§ÌÉ¨ÌîÑÍ∞Ä <span id="stamp-number">0</span>Í∞ú Ï†ÅÎ¶ΩÎêòÏóàÏäµÎãàÎã§.
                                    <br>10Í∞ú Ï†ÅÎ¶Ω Ïãú ÏïÑÎ©îÎ¶¨Ïπ¥ÎÖ∏ Î¨¥Î£å Ïø†Ìè∞ ÏßÄÍ∏â!
                                </p>
                            </div>
                        </div>
                        
                        <div class="option-section">
                            <h2 class="section-title">Í≤∞Ï†ú Î∞©Î≤ï</h2>
                            <div class="payment-options">
                                <button class="payment-option-btn active" data-payment="card">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect x="2" y="5" width="20" height="14" rx="2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <line x1="2" y1="10" x2="22" y2="10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    <span>Ïã†Ïö©Ïπ¥Îìú</span>
                                </button>
                                <button class="payment-option-btn" data-payment="kakaopay">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2C6.48 2 2 5.51 2 9.83C2 12.73 3.94 15.27 6.88 16.63V21.03L12 17.75L17.12 21.03V16.63C20.06 15.27 22 12.73 22 9.83C22 5.51 17.52 2 12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    <span>Ïπ¥Ïπ¥Ïò§ÌéòÏù¥</span>
                                </button>
                                <button class="payment-option-btn" data-payment="naverpay">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect x="2" y="4" width="20" height="16" rx="2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M8 10V14L10.5 12L13 14V10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <line x1="16" y1="10" x2="16" y2="14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    <span>ÎÑ§Ïù¥Î≤ÑÌéòÏù¥</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </main>
                
                <footer class="checkout-footer">
                    <button id="back-button" class="back-btn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Ïù¥Ï†Ñ
                    </button>
                    <button id="pay-button" class="pay-btn">
                        Í≤∞Ï†ú<br>ÌïòÍ∏∞
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 5L19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </footer>
            </div>
        </div>
    </div>
    
    <!-- ÌîºÎìúÎ∞± Î™®Îã¨ -->
    <div class="feedback-modal" id="feedback-modal">
        <div class="modal-content">
            <h2>Íµ¨Îß§Ìï¥Ï£ºÏÖîÏÑú Í∞êÏÇ¨Ìï©ÎãàÎã§!</h2>
            <p>ÏÑúÎπÑÏä§Ïóê ÎåÄÌïú ÎßåÏ°±ÎèÑÎ•º ÏïåÎ†§Ï£ºÏÑ∏Ïöî</p>
            <div class="rating">
                <button class="rating-btn" data-rating="1">üòû</button>
                <button class="rating-btn" data-rating="2">üòê</button>
                <button class="rating-btn" data-rating="3">üôÇ</button>
                <button class="rating-btn" data-rating="4">üòÄ</button>
                <button class="rating-btn" data-rating="5">üòç</button>
            </div>
            <button id="close-modal-btn" class="close-modal-btn">Îã´Í∏∞</button>
        </div>
    </div>
    
    <script>
        // Ïû•Î∞îÍµ¨Îãà Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        const orderItemsContainer = document.getElementById('order-items-container');
        const totalAmountElement = document.getElementById('total-amount');
        
        // Ï£ºÎ¨∏ Ìï≠Î™© ÌëúÏãú
        function displayOrderItems() {
            orderItemsContainer.innerHTML = '';
            let totalAmount = 0;
            
            cart.forEach((item, index) => {
                const orderItem = document.createElement('div');
                orderItem.classList.add('order-item');
                
                // ÏÉÅÌíàÏùò Ï¥ù Í∞ÄÍ≤© Í≥ÑÏÇ∞
                const itemTotal = item.price * item.quantity;
                totalAmount += itemTotal;
                
                orderItem.innerHTML = `
                    <div class="item-name">${item.name} <span class="item-quantity">x${item.quantity}</span></div>
                    <div class="item-price">${itemTotal.toLocaleString()}Ïõê</div>
                `;
                
                orderItemsContainer.appendChild(orderItem);
            });
            
            // Ï¥ùÏï° ÏóÖÎç∞Ïù¥Ìä∏
            totalAmountElement.textContent = totalAmount.toLocaleString() + 'Ïõê';
        }
        
        // Ïä§ÌÉ¨ÌîÑ ÌëúÏãú
        function displayStamps() {
            // Ïã§Ï†ú Íµ¨ÌòÑÏóêÏÑúÎäî ÏÑúÎ≤ÑÏóêÏÑú Í≥†Í∞ùÏùò Ïä§ÌÉ¨ÌîÑ Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏ÏôÄÏïº Ìï®
            // Ïó¨Í∏∞ÏÑúÎäî ÏòàÏãúÎ°ú ÎûúÎç§Ìïú Ïä§ÌÉ¨ÌîÑ Í∞úÏàò ÏÉùÏÑ±
            const stampCountElement = document.getElementById('stamp-count');
            const stampNumberElement = document.getElementById('stamp-number');
            
            // ÌòÑÏû¨ Í∞ÄÏßÄÍ≥† ÏûàÎäî Ïä§ÌÉ¨ÌîÑ Ïàò (Ïã§Ï†úÎ°úÎäî DBÏóêÏÑú Í∞ÄÏ†∏Ïò¥)
            const currentStamps = Math.floor(Math.random() * 8) + 1;
            // Ïù¥Î≤à Ï£ºÎ¨∏ÏúºÎ°ú Ï∂îÍ∞ÄÎê† Ïä§ÌÉ¨ÌîÑ Ïàò (ÏùåÎ£å Ìïú ÏûîÎãπ 1Í∞ú)
            const drinkItems = cart.filter(item => 
                item.name.includes('ÎùºÎñº') || 
                item.name.includes('ÏïÑÎ©îÎ¶¨Ïπ¥ÎÖ∏') || 
                item.name.includes('ÌîÑÎùºÌéòÌéò') ||
                item.name.includes('Ìã∞') ||
                item.name.includes('Ïä§Î¨¥Îîî')
            );
            const newStamps = drinkItems.reduce((total, item) => total + item.quantity, 0);
            
            // Ï¥ù Ïä§ÌÉ¨ÌîÑ Ïàò
            const totalStamps = currentStamps + newStamps;
            stampNumberElement.textContent = totalStamps;
            
            // Ïä§ÌÉ¨ÌîÑ ÏïÑÏù¥ÏΩò ÌëúÏãú
            stampCountElement.innerHTML = '';
            
            for (let i = 0; i < 10; i++) {
                const stampIcon = document.createElement('div');
                stampIcon.classList.add('stamp-icon');
                
                if (i < totalStamps) {
                    stampIcon.classList.add('active');
                    stampIcon.innerHTML = `
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    `;
                } else {
                    stampIcon.innerHTML = `
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    `;
                }
                
                stampCountElement.appendChild(stampIcon);
            }
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ïã§Ìñâ
        window.addEventListener('DOMContentLoaded', () => {
            displayOrderItems();
            displayStamps();
            
            // Ìè¨Ïû• ÏòµÏÖò ÏÑ†ÌÉù
            const optionButtons = document.querySelectorAll('.option-btn');
            optionButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // ÌòÑÏû¨ Í∑∏Î£πÏùò Î™®Îì† Î≤ÑÌäºÏóêÏÑú active ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
                    this.parentElement.querySelectorAll('.option-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // ÌÅ¥Î¶≠Îêú Î≤ÑÌäºÏóê active ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä
                    this.classList.add('active');
                });
            });
            
            // Í≤∞Ï†ú Î∞©Î≤ï ÏÑ†ÌÉù
            const paymentButtons = document.querySelectorAll('.payment-option-btn');
            paymentButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Î™®Îì† Í≤∞Ï†ú Î≤ÑÌäºÏóêÏÑú active ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
                    paymentButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // ÌÅ¥Î¶≠Îêú Î≤ÑÌäºÏóê active ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä
                    this.classList.add('active');
                });
            });
            
            // Ïù¥Ï†Ñ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú Î©îÎâ¥ ÌéòÏù¥ÏßÄÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞
            document.getElementById('back-button').addEventListener('click', function() {
            window.history.back();
        });
        
        // ÌîºÎìúÎ∞± Î™®Îã¨ Îã´Í∏∞ Î≤ÑÌäº
        document.getElementById('close-modal-btn').addEventListener('click', function() {
            document.getElementById('feedback-modal').style.display = 'none';
            
            // Ïû•Î∞îÍµ¨Îãà ÎπÑÏö∞Í∏∞
            localStorage.removeItem('cart');
            
            // Ï≤òÏùå ÌôîÎ©¥ÏúºÎ°ú Ïù¥Îèô
            window.location.href = '{{ url_for("index") }}';
        });
        });
    </script>
</body>
</html>