<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keyosk ê²°ì œ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='checkout.css') }}">
</head>
<body>
    <div class="kiosk-container">
        <div class="kiosk-content">
            <div class="checkout-screen">
                <header class="checkout-header">
                    <h1 class="title">ê²°ì œ</h1>
                </header>
                
                <main class="checkout-content">
                    <div class="order-summary">
                        <h2 class="section-title">ì£¼ë¬¸ ë‚´ì—­</h2>
                        <div class="order-items" id="order-items-container">
                            <!-- ì¥ë°”êµ¬ë‹ˆ í•­ëª©ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                        </div>
                        <div class="order-total">
                            <div class="total-row">
                                <span>ì´ ê²°ì œ ê¸ˆì•¡</span>
                                <span id="total-amount">0ì›</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="checkout-options">
                        <div class="option-section">
                            <h2 class="section-title">í¬ì¥ ì„ íƒ</h2>
                            <div class="option-buttons">
                                <button class="option-btn active" data-option="takeout">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M21 5H3C1.89543 5 1 5.89543 1 7V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V7C23 5.89543 22.1046 5 21 5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M16 3V7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M8 3V7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    í¬ì¥
                                </button>
                                <button class="option-btn" data-option="instore">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M18 8H19C20.0609 8 21.0783 8.42143 21.8284 9.17157C22.5786 9.92172 23 10.9391 23 12C23 13.0609 22.5786 14.0783 21.8284 14.8284C21.0783 15.5786 20.0609 16 19 16H18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M2 8H18V17C18 18.0609 17.5786 19.0783 16.8284 19.8284C16.0783 20.5786 15.0609 21 14 21H6C4.93913 21 3.92172 20.5786 3.17157 19.8284C2.42143 19.0783 2 18.0609 2 17V8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M6 1V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M10 1V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M14 1V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    ë§¤ì¥
                                </button>
                            </div>
                        </div>
                        
                        <div class="option-section stamp-section">
                            <h2 class="section-title">ìŠ¤íƒ¬í”„ ì ë¦½</h2>
                            <div class="stamp-info">
                                <div class="stamp-count" id="stamp-count">
                                    <!-- ìŠ¤íƒ¬í”„ ì•„ì´ì½˜ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                                </div>
                                <p class="stamp-text">
                                    ê³ ê°ë‹˜ì˜ ìŠ¤íƒ¬í”„ê°€ <span id="stamp-number">0</span>ê°œ ì ë¦½ë˜ì—ˆìŠµë‹ˆë‹¤.
                                    <br>10ê°œ ì ë¦½ ì‹œ ì•„ë©”ë¦¬ì¹´ë…¸ ë¬´ë£Œ ì¿ í° ì§€ê¸‰!
                                </p>
                            </div>
                        </div>
                        
                        <div class="option-section">
                            <h2 class="section-title">ê²°ì œ ë°©ë²•</h2>
                            <div class="payment-options">
                                <button class="payment-option-btn active" data-payment="card">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect x="2" y="5" width="20" height="14" rx="2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <line x1="2" y1="10" x2="22" y2="10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    <span>ì‹ ìš©ì¹´ë“œ</span>
                                </button>
                                <button class="payment-option-btn" data-payment="kakaopay">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2C6.48 2 2 5.51 2 9.83C2 12.73 3.94 15.27 6.88 16.63V21.03L12 17.75L17.12 21.03V16.63C20.06 15.27 22 12.73 22 9.83C22 5.51 17.52 2 12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    <span>ì¹´ì¹´ì˜¤í˜ì´</span>
                                </button>
                                <button class="payment-option-btn" data-payment="naverpay">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect x="2" y="4" width="20" height="16" rx="2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <path d="M8 10V14L10.5 12L13 14V10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <line x1="16" y1="10" x2="16" y2="14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    <span>ë„¤ì´ë²„í˜ì´</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </main>
                
                <footer class="checkout-footer">
                    <button id="back-button" class="back-btn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        ì´ì „
                    </button>
                    <button id="pay-button" class="pay-btn">
                        ê²°ì œ<br>í•˜ê¸°
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 5L19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </footer>
            </div>
        </div>
    </div>
    
    <!-- í”¼ë“œë°± ëª¨ë‹¬ -->
    <div class="feedback-modal" id="feedback-modal">
        <div class="modal-content">
            <h2>êµ¬ë§¤í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!</h2>
            <p>ì„œë¹„ìŠ¤ì— ëŒ€í•œ ë§Œì¡±ë„ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”</p>
            <div class="rating">
                <button class="rating-btn" data-rating="1">ğŸ˜</button>
                <button class="rating-btn" data-rating="2">ğŸ˜</button>
                <button class="rating-btn" data-rating="3">ğŸ™‚</button>
                <button class="rating-btn" data-rating="4">ğŸ˜€</button>
                <button class="rating-btn" data-rating="5">ğŸ˜</button>
            </div>
            <button id="close-modal-btn" class="close-modal-btn">ë‹«ê¸°</button>
        </div>
    </div>
    
    <script>
        // ì¥ë°”êµ¬ë‹ˆ ë°ì´í„° ë¡œë“œ
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        const orderItemsContainer = document.getElementById('order-items-container');
        const totalAmountElement = document.getElementById('total-amount');
        
        // ì£¼ë¬¸ í•­ëª© í‘œì‹œ
        function displayOrderItems() {
            orderItemsContainer.innerHTML = '';
            let totalAmount = 0;
            
            cart.forEach((item, index) => {
                const orderItem = document.createElement('div');
                orderItem.classList.add('order-item');
                
                // ìƒí’ˆì˜ ì´ ê°€ê²© ê³„ì‚°
                const itemTotal = item.price * item.quantity;
                totalAmount += itemTotal;
                
                orderItem.innerHTML = `
                    <div class="item-name">${item.name} <span class="item-quantity">x${item.quantity}</span></div>
                    <div class="item-price">${itemTotal.toLocaleString()}ì›</div>
                `;
                
                orderItemsContainer.appendChild(orderItem);
            });
            
            // ì´ì•¡ ì—…ë°ì´íŠ¸
            totalAmountElement.textContent = totalAmount.toLocaleString() + 'ì›';
        }
        
        // ìŠ¤íƒ¬í”„ í‘œì‹œ
        function displayStamps() {
            // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ì„œë²„ì—ì„œ ê³ ê°ì˜ ìŠ¤íƒ¬í”„ ì •ë³´ë¥¼ ê°€ì ¸ì™€ì•¼ í•¨
            // ì—¬ê¸°ì„œëŠ” ì˜ˆì‹œë¡œ ëœë¤í•œ ìŠ¤íƒ¬í”„ ê°œìˆ˜ ìƒì„±
            const stampCountElement = document.getElementById('stamp-count');
            const stampNumberElement = document.getElementById('stamp-number');
            
            // í˜„ì¬ ê°€ì§€ê³  ìˆëŠ” ìŠ¤íƒ¬í”„ ìˆ˜ (ì‹¤ì œë¡œëŠ” DBì—ì„œ ê°€ì ¸ì˜´)
            const currentStamps = Math.floor(Math.random() * 8) + 1;
            // ì´ë²ˆ ì£¼ë¬¸ìœ¼ë¡œ ì¶”ê°€ë  ìŠ¤íƒ¬í”„ ìˆ˜ (ìŒë£Œ í•œ ì”ë‹¹ 1ê°œ)
            const drinkItems = cart.filter(item => 
                item.name.includes('ë¼ë–¼') || 
                item.name.includes('ì•„ë©”ë¦¬ì¹´ë…¸') || 
                item.name.includes('í”„ë¼í˜í˜') ||
                item.name.includes('í‹°') ||
                item.name.includes('ìŠ¤ë¬´ë””')
            );
            const newStamps = drinkItems.reduce((total, item) => total + item.quantity, 0);
            
            // ì´ ìŠ¤íƒ¬í”„ ìˆ˜
            const totalStamps = currentStamps + newStamps;
            stampNumberElement.textContent = totalStamps;
            
            // ìŠ¤íƒ¬í”„ ì•„ì´ì½˜ í‘œì‹œ
            stampCountElement.innerHTML = '';
            
            for (let i = 0; i < 10; i++) {
                const stampIcon = document.createElement('div');
                stampIcon.classList.add('stamp-icon');
                
                if (i < totalStamps) {
                    stampIcon.classList.add('active');
                    stampIcon.innerHTML = `
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    `;
                } else {
                    stampIcon.innerHTML = `
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    `;
                }
                
                stampCountElement.appendChild(stampIcon);
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        window.addEventListener('DOMContentLoaded', () => {
            displayOrderItems();
            displayStamps();
            
            // í¬ì¥ ì˜µì…˜ ì„ íƒ
            const optionButtons = document.querySelectorAll('.option-btn');
            optionButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // í˜„ì¬ ê·¸ë£¹ì˜ ëª¨ë“  ë²„íŠ¼ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
                    this.parentElement.querySelectorAll('.option-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // í´ë¦­ëœ ë²„íŠ¼ì— active í´ë˜ìŠ¤ ì¶”ê°€
                    this.classList.add('active');
                });
            });
            
            // ê²°ì œ ë°©ë²• ì„ íƒ
            const paymentButtons = document.querySelectorAll('.payment-option-btn');
            paymentButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // ëª¨ë“  ê²°ì œ ë²„íŠ¼ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
                    paymentButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // í´ë¦­ëœ ë²„íŠ¼ì— active í´ë˜ìŠ¤ ì¶”ê°€
                    this.classList.add('active');
                });
            });
            
            // ì´ì „ ë²„íŠ¼ í´ë¦­ ì‹œ ë©”ë‰´ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°
            document.getElementById('back-button').addEventListener('click', function() {
            window.history.back();
        });
        
        // í”¼ë“œë°± ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼
        document.getElementById('close-modal-btn').addEventListener('click', function() {
            document.getElementById('feedback-modal').style.display = 'none';
            
            // ì¥ë°”êµ¬ë‹ˆ ë¹„ìš°ê¸°
            localStorage.removeItem('cart');
            
            // ì²˜ìŒ í™”ë©´ìœ¼ë¡œ ì´ë™
            window.location.href = '{{ url_for("index") }}';
        });
        });
    </script>
</body>
</html>